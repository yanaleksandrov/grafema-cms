document.addEventListener("alpine:init",(()=>{let e=()=>{};const t=new XMLHttpRequest;function a(e,t){const{loaded:a=0,total:o=0,type:r}=e,{response:n="",status:l="",responseURL:c=""}=t;let d={blob:new Blob([n]),raw:n,status:l,url:c,loaded:s(a),total:s(o),percent:o>0?Math.round(a/o*100):0,start:"loadstart"===r,progress:"progress"===r,end:"loadend"===r};return d.end&&console.log(d),d}Alpine.magic("ajax",(o=>(s,r,n)=>(document.addEventListener(s,(({detail:{data:e,resolve:t}})=>t(e))),new Promise((l=>{t.open(o.getAttribute("method")?.toUpperCase()??"POST",grafema?.apiurl+s),t.withCredentials=!0,t.responseType="json",t.onloadstart=t.upload.onprogress=e=>n?.(a(e,t)),t.onloadend=e=>n?.(a(e,t)),t.onload=a=>{try{let{data:e,fragments:r}=t.response;document.dispatchEvent(new CustomEvent(s,{detail:{data:e,event:a,el:o,resolve:l},bubbles:!0,composed:!0,cancelable:!0})),r&&r.forEach((({method:e,fragment:t,selectors:a,delay:o})=>{!function(e,t,a="body",o){[...document.querySelectorAll(a)].forEach((a=>{setTimeout((()=>{switch(e){case"changeURL":window.history.pushState(null,null,t||"");break;case"redirect":window.location=t||"";break;case"reload":window.location.reload();break;case"scrollTo":window.scrollBy({top:a.getBoundingClientRect().top,behavior:"smooth"});break;case"value":a.value=t||"";break;case"update":a.innerHTML=t||"";break;case"remove":a.remove();break;case"replace":a.outerHTML=t||"";break;case"afterend":case"beforeend":case"afterbegin":case"beforebegin":a.insertAdjacentHTML(e,t||"");break;case"classList.remove":a.classList.remove(t||"");break;case"classList.add":a.classList.add(t||"");break;case"setAttribute":const[o,s]=t;if(!o)return null;a.setAttribute(o,s||"");break;default:a[e](t||"")}}),o||0)}))}(e,t,a,o)}))}catch(e){console.error(e)}e&&e()},t.send(function(t,a){let o=new FormData;switch(t.tagName){case"BUTTON":t.classList.add("btn--load"),e=()=>t.classList.remove("btn--load");break;case"FORM":let a=t.querySelectorAll("[type='submit']");o=new FormData(t),[...t.querySelectorAll("input[type='file']")].forEach((e=>{let t=e.files;t&&[...t].forEach(((e,t)=>o.append(t,e)))})),a&&a.forEach((e=>e.classList.add("btn--load"))),e=()=>a&&a.forEach((e=>e.classList.remove("btn--load")));break;case"TEXTAREA":case"SELECT":case"INPUT":"file"!==t.type&&t.name&&o.append(t.name,t.value)}if("object"==typeof a)for(const[e,t]of Object.entries(a))o.append(e,t);return o}(o,r))})))));const o=1048576;function s(e){return Math.round(e/o*100)/100}}));