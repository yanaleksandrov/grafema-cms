document.addEventListener("alpine:init",(()=>{let e=()=>{},t=new FormData;const a=new XMLHttpRequest;function o(e,t){const{loaded:a=0,total:o=0,type:s}=e,{response:n="",status:l="",responseURL:c=""}=t;let d={blob:new Blob([n]),raw:n,status:l,url:c,loaded:r(a),total:r(o),percent:o>0?Math.round(a/o*100):0,start:"loadstart"===s,progress:"progress"===s,end:"loadend"===s};return d.end&&console.log(d),d}Alpine.magic("ajax",(s=>(r,n,l)=>(document.addEventListener(r,(({detail:{data:e,resolve:t}})=>t(e))),new Promise((c=>{a.open(s.getAttribute("method")?.toUpperCase()??"POST",grafema?.apiurl+r),a.withCredentials=!0,a.responseType="json",a.onloadstart=a.upload.onprogress=e=>l?.(o(e,a)),a.onloadend=e=>l?.(o(e,a)),a.onload=t=>{let{data:o,fragments:n}=a.response;document.dispatchEvent(new CustomEvent(r,{detail:{data:o,event:t,el:s,resolve:c},bubbles:!0,composed:!0,cancelable:!0})),n&&n.forEach((({method:e,fragment:t,selectors:a,delay:o})=>{!function(e,t,a="body",o){[...document.querySelectorAll(a)].forEach((a=>{setTimeout((()=>{switch(e){case"changeURL":window.history.pushState(null,null,t||"");break;case"redirect":window.location=t||"";break;case"reload":window.location.reload();break;case"scrollTo":window.scrollBy({top:a.getBoundingClientRect().top,behavior:"smooth"});break;case"value":a.value=t||"";break;case"update":a.innerHTML=t||"";break;case"remove":a.remove();break;case"replace":a.outerHTML=t||"";break;case"afterend":case"beforeend":case"afterbegin":case"beforebegin":a.insertAdjacentHTML(e,t||"");break;case"classList.remove":a.classList.remove(t||"");break;case"classList.add":a.classList.add(t||"");break;case"setAttribute":const[o,s]=t;if(!o)return null;a.setAttribute(o,s||"");break;default:a[e](t||"")}}),o||0)}))}(e,t,a,o)})),e&&e()},a.send(function(a,o){switch(a.tagName){case"BUTTON":a.classList.add("btn--load"),e=()=>a.classList.remove("btn--load");break;case"FORM":let o=a.querySelectorAll("[type='submit']");t=new FormData(a),[...a.querySelectorAll("input[type='file']")].forEach((e=>{let a=e.files;a&&[...a].forEach(((e,a)=>t.append(a,e)))})),o&&o.forEach((e=>e.classList.add("btn--load"))),e=()=>o&&o.forEach((e=>e.classList.remove("btn--load")));break;case"TEXTAREA":case"SELECT":case"INPUT":"file"!==a.type&&a.name&&t.append(a.name,a.value)}if("object"==typeof o)for(const[e,a]of Object.entries(o))t.append(e,a);return t}(s,n))})))));const s=1048576;function r(e){return Math.round(e/s*100)/100}}));