document.addEventListener("alpine:init",(()=>{let e=()=>{};const t=new XMLHttpRequest;function a(e,t){const{loaded:a=0,total:s=0,type:r}=e,{response:n="",status:l="",responseURL:c=""}=t;let d={blob:new Blob([n]),raw:n,status:l,url:c,loaded:o(a),total:o(s),percent:s>0?Math.round(a/s*100):0,start:"loadstart"===r,progress:"progress"===r,end:"loadend"===r};return d.end&&console.log(d),d}Alpine.magic("ajax",(s=>(o,r,n)=>(document.addEventListener(o,(({detail:{data:e,resolve:t}})=>t(e))),new Promise((l=>{t.open(s.getAttribute("method")?.toUpperCase()??"POST",grafema?.apiurl+o),t.withCredentials=!0,t.responseType="json",t.onloadstart=t.upload.onprogress=e=>n?.(a(e,t)),t.onloadend=e=>n?.(a(e,t)),t.onload=a=>{try{let{data:e}=t.response;document.dispatchEvent(new CustomEvent(o,{detail:{data:e,event:a,el:s,resolve:l},bubbles:!0,composed:!0,cancelable:!0})),e&&e.forEach((({method:e,fragment:t,selectors:a,delay:s})=>{!function(e,t,a="body",s){[...document.querySelectorAll(a)].forEach((a=>{setTimeout((()=>{switch(e){case"changeURL":window.history.pushState(null,null,t||"");break;case"redirect":window.location=t||"";break;case"reload":window.location.reload();break;case"scrollTo":window.scrollBy({top:a.getBoundingClientRect().top,behavior:"smooth"});break;case"value":a.value=t||"";break;case"update":a.innerHTML=t||"";break;case"remove":a.remove();break;case"replace":a.outerHTML=t||"";break;case"insertAfterEnd":case"insertBeforeEnd":case"insertAfterBegin":case"insertBeforeBegin":a.insertAdjacentHTML(e.replace("insertB","b").replace("insertA","a").toLowerCase(),t||"");break;case"classList.remove":a.classList.remove(t||"");break;case"classList.add":a.classList.add(t||"");break;case"setAttribute":const[s,o]=t;if(!s)return null;a.setAttribute(s,o||"");break;case"append":case"prepend":case"replaceWith":case"scrollIntoView":case"removeAttribute":a[e](t||"")}}),s||0)}))}(e,t,a,s)}))}catch(e){console.error(e)}e&&e()},t.send(function(t,a){let s=new FormData;switch(t.tagName){case"BUTTON":t.classList.add("btn--load"),e=()=>t.classList.remove("btn--load");break;case"FORM":let a=t.querySelectorAll("[type='submit']");s=new FormData(t),[...t.querySelectorAll("input[type='file']")].forEach((e=>{let t=e.files;t&&[...t].forEach(((e,t)=>s.append(t,e)))})),a&&a.forEach((e=>e.classList.add("btn--load"))),e=()=>a&&a.forEach((e=>e.classList.remove("btn--load")));break;case"TEXTAREA":case"SELECT":case"INPUT":"file"!==t.type&&t.name&&s.append(t.name,t.value)}if("object"==typeof a)for(const[e,t]of Object.entries(a))s.append(e,t);return s}(s,r))})))));const s=1048576;function o(e){return Math.round(e/s*100)/100}}));