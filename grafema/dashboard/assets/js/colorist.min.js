!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.colorist=e()}(this,(function(){"use strict";var t={},e=!1,o=!1,n=!1,i=[0,100,50],a=1,s=220,r=220,l=220,c={options:{},init:function(i,a){this.elem=i,this.options=Object.assign(this.options,{default:i.value?i.value:"#000",palette:["#eb144c","#ff6900","#fcb900","#ffed2d","#7bdcb5","#8ed1fc","#d8a1e4","#d8d8d8","#737373"],choosen:function(){}},JSON.parse(i.getAttribute("data-colorist")),a);var u="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch||0<navigator.maxTouchPoints||0<window.navigator.msMaxTouchPoints,d=i.nextSibling.nextElementSibling;if(d&&d.classList.contains("colorist")||i.insertAdjacentHTML("afterend",'<div class="colorist" draggable="false"><div class="colorist__box" draggable="false"><div class="colorist__box_point point"></div></div><div class="colorist__hue"><div class="colorist__hue_point point"></div></div><div class="colorist__alpha"><div class="colorist__alpha_point point"></div></div><div class="colorist__dye"></div</div>'),t={input:i,colorist:document.querySelector(".colorist"),hue:document.querySelector(".colorist__hue"),box:document.querySelector(".colorist__box"),alpha:document.querySelector(".colorist__alpha"),dye:document.querySelector(".colorist__dye"),box_point:document.querySelector(".colorist__box_point"),hue_point:document.querySelector(".colorist__hue_point"),alpha_point:document.querySelector(".colorist__alpha_point")},s=t.box.offsetWidth,r=t.box.offsetHeight,l=t.hue.offsetHeight,this.setColors(this.options.default),this.options.palette&&!t.dye.hasChildNodes()&&this.options.palette.forEach((function(e){t.dye.insertAdjacentHTML("beforeend",'<i class="colorist__dye_point" style="color: '+e+'"></i>')})),document.addEventListener(u?"touchstart":"mousedown",(function(e){t.colorist&&!t.colorist.contains(e.target)&&(t.colorist.parentNode.removeChild(t.colorist),t.colorist=null)})),t.colorist.style.visibility="visible",t.colorist.style.opacity=1,this.options.palette&&t.dye.hasChildNodes()){var p=document.querySelectorAll(".colorist__dye_point");for(var f of p)f.addEventListener(u?"touchstart":"click",(function(e){c.setColors(e.target.style.color),t.input.value=e.target.style.color,c.options.choosen(t.input,e.target.style.color)}))}t.hue.addEventListener(u?"touchstart":"mousedown",(function(o){e=!0,t.hue_point.classList.add("active"),c.setHuePickerValue(o)})),t.alpha.addEventListener(u?"touchstart":"mousedown",(function(e){o=!0,t.alpha_point.classList.add("active"),c.setAlphaPickerValue(e)})),t.box.addEventListener(u?"touchstart":"mousedown",(function(e){n=!0,t.box_point.classList.add("active"),c.setSatPickerValue(e)})),document.addEventListener(u?"touchmove":"mousemove",(function(t){n&&c.setSatPickerValue(t),e&&c.setHuePickerValue(t),o&&c.setAlphaPickerValue(t),c.setPickerIcon()})),document.addEventListener(u?"touchend":"mouseup",(function(){n&&(t.box_point.classList.remove("active"),n=!1),e&&(t.hue_point.classList.remove("active"),e=!1),o&&(t.alpha_point.classList.remove("active"),o=!1),c.setPickerIcon()}))},setColors:function(e){var o=c.hexToRgba(e);if(o||(o=e.replace(/^rgba?\(|\s+|\)$/g,"").split(","),o={r:parseInt(o[0]),g:parseInt(o[1]),b:parseInt(o[2]),a:o[3]?parseFloat(o[3]):1}),a=o.a,o){var n=[o.r,o.g,o.b],s=c.rgbToHsl(n),r=c.rgbToHsv(o.r,o.g,o.b);i=s,Object.assign(t.box.style,{background:"hsl("+s[0]+", 100%, 50%)"}),Object.assign(t.box_point.style,{left:s[1]+"%",top:100-100*r[2]+"%"}),Object.assign(t.hue_point.style,{background:"hsl("+s[0]+", 100%, 50%)",top:s[0]/360*100+"%"}),Object.assign(t.alpha.style,{background:"linear-gradient( 180deg, rgba("+n.join(", ")+", 1), rgba("+n.join(", ")+", 0) )"}),Object.assign(t.alpha_point.style,{top:100-100*o.a+"%"})}},rgbToHsv:function(t,e,o){1===arguments.length&&(e=t.g,o=t.b,t=t.r);var n,i=Math.max(t,e,o),a=Math.min(t,e,o),s=i-a;return i===a?n=0:i===t?(n=e-o+s*(e<o?6:0),n/=6*s):i===e?(n=o-t+2*s,n/=6*s):i===o&&(n=t-e+4*s,n/=6*s),[n,0===i?0:s/i,i/255]},rgbToHsl:function(t){var e=t[0]/255,o=t[1]/255,n=t[2]/255,i=Math.max(e,o,n),a=Math.min(e,o,n),s=(i+a)/2,r=0,l=0;return i!=a&&(r=.5>s?(i-a)/(i+a):(i-a)/(2-i-a),l=e==i?(o-n)/(i-a):o==i?2+(n-e)/(i-a):4+(e-o)/(i-a)),0>(l*=60)&&(l+=360),[l,r*=100,s*=100]},rgbaToHex:function(t,e,o,n=1){var i=1>n?(255*n|256).toString(16).slice(1):"";return"#"+(16777216+(o|e<<8|t<<16)).toString(16).slice(1)+i},hexToRgba:function(t){3===(t=t.replace(/#/g,"")).length&&(t=t.split("").map((function(t){return t+t})).join(""));var e=/^([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})[\da-z]{0,0}$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16),a:e[4]?parseInt(e[4],16):1}:null},bound01:function(t,e){"string"==typeof t&&-1!=t.indexOf(".")&&1===parseFloat(t)&&(t="100%");var o="string"==typeof t&&-1!=t.indexOf("%");return t=Math.min(e,Math.max(0,parseFloat(t))),o&&(t=parseInt(t*e,10)/100),1e-6>Math.abs(t-e)?1:t%e/parseFloat(e)},hslToRgb:function(t,e,o){function n(t,e,o){return 0>o&&(o+=1),1<o&&(o-=1),o<1/6?t+6*(e-t)*o:o<.5?e:o<2/3?t+(e-t)*(2/3-o)*6:t}var i,a,s;if(t=c.bound01(t,360),e=c.bound01(e,100),o=c.bound01(o,100),0===e)i=a=s=o;else{var r=.5>o?o*(1+e):o+e-o*e,l=2*o-r;i=n(l,r,t+1/3),a=n(l,r,t),s=n(l,r,t-1/3)}return[Math.round(255*i),Math.round(255*a),Math.round(255*s)]},offset:function(t){var e,o,n={top:0,left:0},i=t&&t.ownerDocument;return e=i.documentElement,void 0!==t.getBoundingClientRect&&(n=t.getBoundingClientRect()),o=null!==i&&i===i.window?i:9===i.nodeType&&i.defaultView,{top:n.top+o.pageYOffset-e.clientTop,left:n.left+o.pageXOffset-e.clientLeft}},segmentNumber:function(t,e,o){return Math.max(e,Math.min(t,o))},returnPickedColor:function(){var e=c.hslToRgb(i[0],i[1],i[2]),o=c.rgbaToHex(e[0],e[1],e[2],a);if(t.hue_point.style.background="hsl( "+i[0]+",100%, 50% )",t.alpha.style.background="linear-gradient( 180deg, rgba("+e.join(", ")+", 1), rgba("+e.join(", ")+", 0) )",1>a)var n="rgba("+e.join(", ")+", "+parseFloat(a.toPrecision(2))+")";else n=o.toUpperCase();t.input.value=n,c.options.choosen(t.input,n)},setHuePickerValue:function(e){i[0]=c.segmentNumber(Math.floor(((e.pageY||e.touches[0].pageY)-c.offset(t.box).top)/l*360),0,360),t.hue_point.style.top=c.segmentNumber(((e.pageY||e.touches[0].pageY)-c.offset(t.box).top)/l*100,0,l/2)+"%",t.box.style.background="hsl("+i[0]+", 100%, 50%)",c.returnPickedColor()},setAlphaPickerValue:function(e){a=c.segmentNumber(((e.pageY||e.touches[0].pageY)-c.offset(t.box).top)/l*100,0,l/2),t.alpha_point.style.top=a+"%",a=(100-a)/100,c.returnPickedColor()},setSatPickerValue:function(e){var o=c.offset(t.box).left,n=c.offset(t.box).top,a=e.pageX||e.touches[0].pageX,l=e.pageY||e.touches[0].pageY,u=[c.segmentNumber(a-o,0,s),c.segmentNumber(l-n,0,r)];t.box_point.style.left=u[0]+"px",t.box_point.style.top=u[1]+"px",i[1]=Math.floor(u[0]/s*100);a-=c.offset(t.box).left,l-=c.offset(t.box).top;a>s&&(a=s),0>a&&(a=0),l>r&&(l=r),0>l&&(l=0);var d=a/s*100,p=l/r*100;i[2]=Math.floor((1-p/100)/2*(2-d/100)*100),c.returnPickedColor()},setPickerIcon:function(){this.elem.style.backgroundRepeat="no-repeat",this.elem.style.backgroundPosition="right 4px center",this.elem.style.backgroundImage="url(\"data:image/svg+xml;charset=UTF-8,%3csvg width='28' height='28' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3ccircle cx='14' cy='14' r='14' fill='"+this.elem.value.replace("#","%23")+"'/%3e%3cpath d='M19.84 17.38a.45.45 0 00-.68 0C18.7 17.9 18 18.83 18 19.5c0 .97.5 1.5 1.5 1.5.97 0 1.5-.53 1.5-1.5 0-.67-.71-1.6-1.16-2.12zm.9-4.44l-5.68-5.68a.87.87 0 00-1.23 0l-1.88 1.87a.5.5 0 01-.7 0l-2.01-2a.44.44 0 00-.62 0L8 7.75a.44.44 0 000 .62l2 2c.2.2.2.51 0 .7l-2.23 2.24a2.62 2.62 0 000 3.72l3.2 3.2a2.62 2.62 0 003.71 0l6.06-6.06a.87.87 0 000-1.23zm-3.1 1.9a.5.5 0 01-.35.16H9.83a.5.5 0 01-.36-.85l1.77-1.82c.2-.2.52-.2.72-.01l1.24 1.24a.87.87 0 001.24-1.23l-1.25-1.25a.5.5 0 010-.7l.9-.91c.2-.2.51-.2.71 0l3.74 3.74c.2.19.2.5 0 .7l-.9.94z' fill='%23fff'/%3e%3c/svg%3e\")"}};return c}));