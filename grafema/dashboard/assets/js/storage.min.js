(()=>{"use strict";class t{constructor(t,e=0,s=0){this.id=t.id||"selectionArea",this.class=t.class||!1,this.x=e,this.y=s,this.w=0,this.h=0}instance(t){let e=document.createElement("div");e.setAttribute("id",this.id),e.setAttribute("style","background: rgba(52, 152, 219, 0.1); border: 1px solid #4089c3; position: absolute; z-index: 1000; top: 0; left: 0;"),this.class&&e.setAttribute("class",this.class),t.appendChild(e),this.parent=t,this.elem=document.getElementById(this.id)}resize(t,e){this.w=Math.abs(this.x-t),this.h=Math.abs(this.y-e)}move(t,e){let s=this.y>=e?e:this.y,i=this.x>=t?t:this.x,n=this.w,a=this.h;this.elem.style.top=`${s}px`,this.elem.style.left=`${i}px`,this.elem.style.width=`${n}px`,this.elem.style.height=`${a}px`}destroy(){this.parent.contains(this.elem)&&this.parent.removeChild(this.elem)}isOver(t){let e=this.elem.getBoundingClientRect(),s=t.getBoundingClientRect(),i=e.top,n=e.left,a=e.top+e.height,r=e.left+e.width,h=s.top,o=s.left,c=s.top+s.height,l=s.left+s.width;return!(o>r||l<n||h>a||c<i)}}const e="mousedown",s="mousemove",i="mouseup",n="touchstart",a="touchmove",r="touchend";const h=class{constructor(t){try{this.nodes=[],this.container=this.validateContainer(t.container||document.querySelector(".parent")),this.selector=this.validateSelector(t.selector||".child"),this.areaAttributes=t.areaAttributes||{id:"my-custom-area",class:""},this.touchable=t.touchable||"ontouchstart"in window||navigator.maxTouchPoints||!0,this.autostart=t.autostart||!0,this.onSelectEnd=t.onSelectEnd||null,this.classSelected="selected"}catch(t){throw t}this.autostart&&this.start()}validateContainer(t){if(!(t&&t instanceof HTMLElement))throw new Error('"container" attribute must be HTMLElement');return t}validateSelector(t){if(!t)throw new Error('"elements" attribute must be defined');if("string"==typeof t)return t;throw new Error('"elements" property must be a String')}start(){this.container.addEventListener(e,this),this.container.addEventListener(s,this),this.container.addEventListener(i,this),this.touchable&&(this.container.addEventListener(n,this),this.container.addEventListener(a,this),this.container.addEventListener(r,this))}stop(){this.container.removeEventListener(e,this),this.container.removeEventListener(s,this),this.container.removeEventListener(i,this),this.touchable&&(this.container.removeEventListener(n,this),this.container.removeEventListener(a,this),this.container.removeEventListener(r,this))}handleEvent(t){t.preventDefault();let h=this.touchable&&t.targetTouches&&t.targetTouches.length?t.targetTouches[0]:t,[o,c]=[h.pageX,h.pageY];switch(t.type){case e:case n:this.init(o,c);break;case s:case a:this.update(o,c);break;case i:case r:this.end(o,c)}}init(e,s){this.selected=[],this.area=new t(this.areaAttributes,e,s),this.area.instance(this.container)}update(t,e){this.area&&(Array.from(this.container.querySelectorAll(this.selector)).forEach((t=>{this.nodes.includes(t)||(this.area.isOver(t)?t.classList.add(this.classSelected):t.classList.remove(this.classSelected))})),this.area.resize(t,e),this.area.move(t,e))}end(){if(this.area){let t=Array.from(this.container.querySelectorAll(this.selector));this.selected=t.filter((t=>this.area.isOver(t)&&-1===this.selected.indexOf(t))),this.nodes=this.nodes.concat(this.selected.filter((t=>!this.nodes.includes(t)))),this.selected.forEach((t=>{t.classList.contains(this.classSelected)||t.classList.add(this.classSelected)})),this.area.destroy(),this.area=null,"function"==typeof this.onSelectEnd&&this.onSelectEnd(this)}}};document.addEventListener("alpine:init",(()=>{Alpine.directive("storage",((t,{value:e,expression:s,modifiers:i},{evaluateLater:n,cleanup:a})=>{let r=new h({container:document.querySelector(".parent"),onSelectEnd:t=>{console.log(t)}});console.log(r)}))}))})();