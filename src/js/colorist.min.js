(function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.colorist=b()})(this,function(){'use strict';var a={},b=!1,c=!1,d=!1,f=[0,100,50],g=1,h=220,i=220,j=220,k={options:{},init:function(e,f){this.elem=e,this.options=Object.assign(this.options,{default:e.value?e.value:"#000",palette:["#eb144c","#ff6900","#fcb900","#ffed2d","#7bdcb5","#8ed1fc","#d8a1e4","#d8d8d8","#737373"],choosen:function(){}},JSON.parse(e.getAttribute("data-colorist")),f);var g="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch||0<navigator.maxTouchPoints||0<window.navigator.msMaxTouchPoints,l=e.nextSibling.nextElementSibling;if(l&&l.classList.contains("colorist")||e.insertAdjacentHTML("afterend",`<div class="colorist" draggable="false"><div class="colorist__box" draggable="false"><div class="colorist__box_point point"></div></div><div class="colorist__hue"><div class="colorist__hue_point point"></div></div><div class="colorist__alpha"><div class="colorist__alpha_point point"></div></div><div class="colorist__dye"></div</div>`),a={input:e,colorist:document.querySelector(".colorist"),hue:document.querySelector(".colorist__hue"),box:document.querySelector(".colorist__box"),alpha:document.querySelector(".colorist__alpha"),dye:document.querySelector(".colorist__dye"),box_point:document.querySelector(".colorist__box_point"),hue_point:document.querySelector(".colorist__hue_point"),alpha_point:document.querySelector(".colorist__alpha_point")},h=a.box.offsetWidth,i=a.box.offsetHeight,j=a.hue.offsetHeight,this.setColors(this.options.default),this.options.palette&&!a.dye.hasChildNodes()&&this.options.palette.forEach(function(b){a.dye.insertAdjacentHTML("beforeend","<i class=\"colorist__dye_point\" style=\"color: "+b+"\"></i>")}),document.addEventListener(g?"touchstart":"mousedown",function(b){a.colorist&&!a.colorist.contains(b.target)&&(a.colorist.parentNode.removeChild(a.colorist),a.colorist=null)}),a.colorist.style.visibility="visible",a.colorist.style.opacity=1,this.options.palette&&a.dye.hasChildNodes()){var m=document.querySelectorAll(".colorist__dye_point");for(var n of m)n.addEventListener(g?"touchstart":"click",function(b){k.setColors(b.target.style.color),a.input.value=b.target.style.color,k.options.choosen(a.input,b.target.style.color)})}a.hue.addEventListener(g?"touchstart":"mousedown",function(c){b=!0,a.hue_point.classList.add("active"),k.setHuePickerValue(c)}),a.alpha.addEventListener(g?"touchstart":"mousedown",function(b){c=!0,a.alpha_point.classList.add("active"),k.setAlphaPickerValue(b)}),a.box.addEventListener(g?"touchstart":"mousedown",function(b){d=!0,a.box_point.classList.add("active"),k.setSatPickerValue(b)}),document.addEventListener(g?"touchmove":"mousemove",function(a){d&&k.setSatPickerValue(a),b&&k.setHuePickerValue(a),c&&k.setAlphaPickerValue(a),k.setPickerIcon()}),document.addEventListener(g?"touchend":"mouseup",function(){d&&(a.box_point.classList.remove("active"),d=!1),b&&(a.hue_point.classList.remove("active"),b=!1),c&&(a.alpha_point.classList.remove("active"),c=!1),k.setPickerIcon()})},setColors:function(b){var c=k.hexToRgba(b);if(c||(c=b.replace(/^rgba?\(|\s+|\)$/g,"").split(","),c={r:parseInt(c[0]),g:parseInt(c[1]),b:parseInt(c[2]),a:c[3]?parseFloat(c[3]):1}),g=c.a,c){var d=[c.r,c.g,c.b],e=k.rgbToHsl(d),h=k.rgbToHsv(c.r,c.g,c.b);f=e,Object.assign(a.box.style,{background:"hsl("+e[0]+", 100%, 50%)"}),Object.assign(a.box_point.style,{left:e[1]+"%",top:100-100*h[2]+"%"}),Object.assign(a.hue_point.style,{background:"hsl("+e[0]+", 100%, 50%)",top:100*(e[0]/360)+"%"}),Object.assign(a.alpha.style,{background:"linear-gradient( 180deg, rgba("+d.join(", ")+", 1), rgba("+d.join(", ")+", 0) )"}),Object.assign(a.alpha_point.style,{top:100-100*c.a+"%"})}},rgbToHsv:function(a,c,e){1===arguments.length&&(c=a.g,e=a.b,a=a.r);var f,i=Math.max(a,c,e),j=Math.min(a,c,e),k=i-j,d=0===i?0:k/i;return i===j?f=0:i===a?(f=c-e+k*(c<e?6:0),f/=6*k):i===c?(f=e-a+2*k,f/=6*k):i===e?(f=a-c+4*k,f/=6*k):void 0,[f,d,i/255]},rgbToHsl:function(a){var b=a[0]/255,c=a[1]/255,d=a[2]/255,e=Math.max(b,c,d),f=Math.min(b,c,d),g=(e+f)/2,h=0,i=0;return e!=f&&(h=.5>g?(e-f)/(e+f):(e-f)/(2-e-f),i=b==e?(c-d)/(e-f):c==e?2+(d-b)/(e-f):4+(b-c)/(e-f)),g*=100,h*=100,i*=60,0>i&&(i+=360),[i,h,g]},rgbaToHex:function(c,d,e,b=1){var a=1>b?(255*b|256).toString(16).slice(1):"";return"#"+(16777216+(e|d<<8|c<<16)).toString(16).slice(1)+a},hexToRgba:function(a){a=a.replace(/#/g,""),3===a.length&&(a=a.split("").map(function(a){return a+a}).join(""));var b=/^([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})[\da-z]{0,0}$/i.exec(a);return b?{r:parseInt(b[1],16),g:parseInt(b[2],16),b:parseInt(b[3],16),a:b[4]?parseInt(b[4],16):1}:null},bound01:function(a,b){"string"==typeof a&&-1!=a.indexOf(".")&&1===parseFloat(a)&&(a="100%");var c="string"==typeof a&&-1!=a.indexOf("%");return a=Math.min(b,Math.max(0,parseFloat(a))),c&&(a=parseInt(a*b,10)/100),1e-6>Math.abs(a-b)?1:a%b/parseFloat(b)},hslToRgb:function(a,c,d){function e(a,b,c){return 0>c&&(c+=1),1<c&&(c-=1),c<1/6?a+6*(b-a)*c:c<1/2?b:c<2/3?a+6*((b-a)*(2/3-c)):a}var f,i,j;if(a=k.bound01(a,360),c=k.bound01(c,100),d=k.bound01(d,100),0===c)f=i=j=d;else{var m=.5>d?d*(1+c):d+c-d*c,n=2*d-m;f=e(n,m,a+1/3),i=e(n,m,a),j=e(n,m,a-1/3)}return[Math.round(255*f),Math.round(255*i),Math.round(255*j)]},offset:function(a){var b,c,d={top:0,left:0},e=a&&a.ownerDocument;return b=e.documentElement,"undefined"!=typeof a.getBoundingClientRect&&(d=a.getBoundingClientRect()),c=null!==e&&e===e.window?e:9===e.nodeType&&e.defaultView,{top:d.top+c.pageYOffset-b.clientTop,left:d.left+c.pageXOffset-b.clientLeft}},segmentNumber:function(a,b,c){return Math.max(b,Math.min(a,c))},returnPickedColor:function(){var b=k.hslToRgb(f[0],f[1],f[2]),c=k.rgbaToHex(b[0],b[1],b[2],g);if(a.hue_point.style.background="hsl( "+f[0]+",100%, 50% )",a.alpha.style.background="linear-gradient( 180deg, rgba("+b.join(", ")+", 1), rgba("+b.join(", ")+", 0) )",1>g)var d="rgba("+b.join(", ")+", "+parseFloat(g.toPrecision(2))+")";else var d=c.toUpperCase();a.input.value=d,k.options.choosen(a.input,d)},setHuePickerValue:function(b){f[0]=k.segmentNumber(Math.floor(360*(((b.pageY||b.touches[0].pageY)-k.offset(a.box).top)/j)),0,360),a.hue_point.style.top=k.segmentNumber(100*(((b.pageY||b.touches[0].pageY)-k.offset(a.box).top)/j),0,j/2)+"%",a.box.style.background="hsl("+f[0]+", 100%, 50%)",k.returnPickedColor()},setAlphaPickerValue:function(b){g=k.segmentNumber(100*(((b.pageY||b.touches[0].pageY)-k.offset(a.box).top)/j),0,j/2),a.alpha_point.style.top=g+"%",g=(100-g)/100,k.returnPickedColor()},setSatPickerValue:function(b){var c={left:k.offset(a.box).left,top:k.offset(a.box).top},d=b.pageX||b.touches[0].pageX,e=b.pageY||b.touches[0].pageY,g=[k.segmentNumber(d-c.left,0,h),k.segmentNumber(e-c.top,0,i)];a.box_point.style.left=g[0]+"px",a.box_point.style.top=g[1]+"px",f[1]=Math.floor(100*(g[0]/h));var d=d-k.offset(a.box).left,e=e-k.offset(a.box).top;d>h&&(d=h),0>d&&(d=0),e>i&&(e=i),0>e&&(e=0);var j=100*(d/h),l=100*(e/i);f[2]=Math.floor(100*((1-l/100)/2*(2-j/100))),k.returnPickedColor()},setPickerIcon:function(){this.elem.style.backgroundRepeat="no-repeat",this.elem.style.backgroundPosition="right 4px center",this.elem.style.backgroundImage="url(\"data:image/svg+xml;charset=UTF-8,%3csvg width='28' height='28' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3ccircle cx='14' cy='14' r='14' fill='"+this.elem.value.replace("#","%23")+"'/%3e%3cpath d='M19.84 17.38a.45.45 0 00-.68 0C18.7 17.9 18 18.83 18 19.5c0 .97.5 1.5 1.5 1.5.97 0 1.5-.53 1.5-1.5 0-.67-.71-1.6-1.16-2.12zm.9-4.44l-5.68-5.68a.87.87 0 00-1.23 0l-1.88 1.87a.5.5 0 01-.7 0l-2.01-2a.44.44 0 00-.62 0L8 7.75a.44.44 0 000 .62l2 2c.2.2.2.51 0 .7l-2.23 2.24a2.62 2.62 0 000 3.72l3.2 3.2a2.62 2.62 0 003.71 0l6.06-6.06a.87.87 0 000-1.23zm-3.1 1.9a.5.5 0 01-.35.16H9.83a.5.5 0 01-.36-.85l1.77-1.82c.2-.2.52-.2.72-.01l1.24 1.24a.87.87 0 001.24-1.23l-1.25-1.25a.5.5 0 010-.7l.9-.91c.2-.2.51-.2.71 0l3.74 3.74c.2.19.2.5 0 .7l-.9.94z' fill='%23fff'/%3e%3c/svg%3e\")"}};return k});
